#!/usr/bin/make -f

export DH_VERBOSE = 1

%:
	dh $@ --with dkms

override_dh_auto_build:
	$(MAKE) wb-wiegand-mqtt

override_dh_auto_install:
	# Install userspace daemon and service
	install -D -m755 wb-wiegand-mqtt debian/wb-wiegand-mqtt/usr/bin/wb-wiegand-mqtt
	install -D -m644 wb-wiegand.conf debian/wb-wiegand-mqtt/etc/wb-wiegand.conf
	install -D -m644 wb-wiegand-mqtt.service debian/wb-wiegand-mqtt/lib/systemd/system/wb-wiegand-mqtt.service

	# Install DKMS source
	install -d debian/wiegand-gpio-dkms/usr/src/wiegand-gpio-0.2.0
	install -m644 wiegand-gpio.c Makefile dkms.conf debian/wiegand-gpio-dkms/usr/src/wiegand-gpio-0.2.0/
